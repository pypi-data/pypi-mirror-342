(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2423],{86850:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/[monitorId]",function(){return s(56856)}])},35287:function(e,t,s){"use strict";var n=s(24246),i=s(77181),o=s(88038),a=s.n(o);s(27378),t.Z=e=>{let{children:t,title:s,mainProps:o}=e;return(0,n.jsxs)(i.kCb,{"data-testid":s,direction:"column",height:"calc(100vh - 48px)",width:"calc(100vw - 240px)",children:[(0,n.jsxs)(a(),{children:[(0,n.jsxs)("title",{children:["Fides Admin UI - ",s]}),(0,n.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsx)(i.kCb,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...o,children:t})]})}},37059:function(e,t,s){"use strict";s.d(t,{Ak:function(){return g},EY:function(){return c},Ud:function(){return o},Vr:function(){return h},WJ:function(){return r},nP:function(){return d},nS:function(){return u},rs:function(){return l},sX:function(){return m},wi:function(){return a}});var n=s(78780),i=s(16394);let{useGetAggregateMonitorResultsQuery:o,useGetDiscoveredSystemAggregateQuery:a,useGetDiscoveredAssetsQuery:r,useAddMonitorResultSystemsMutation:l,useIgnoreMonitorResultSystemsMutation:d,useAddMonitorResultAssetsMutation:c,useIgnoreMonitorResultAssetsMutation:u,useUpdateAssetsSystemMutation:m,useUpdateAssetsDataUseMutation:g,useUpdateAssetsMutation:h}=n.u.injectEndpoints({endpoints:e=>({getAggregateMonitorResults:e.query({query:e=>{let{page:t=1,size:s=20,search:n}=e;return{url:"/plus/discovery-monitor/aggregate-results",params:{page:t,size:s,search:n,diff_status:"addition"}}},providesTags:["Discovery Monitor Results"]}),getDiscoveredSystemAggregate:e.query({query:e=>{let{key:t,page:s=1,size:n=20,search:i,diff_status:o}=e;return{url:"/plus/discovery-monitor/system-aggregate-results",params:{monitor_config_id:t,page:s,size:n,search:i,diff_status:o}}},providesTags:["Discovery Monitor Results"]}),getDiscoveredAssets:e.query({query:e=>{let{key:t,system:s,page:n=1,size:i=20,search:o,diff_status:a}=e;return{url:"/plus/discovery-monitor/".concat(t,"/results"),params:{resolved_system_id:s,page:n,size:i,search:o,diff_status:a,sort_by:"urn"}}},providesTags:()=>["Discovery Monitor Results"]}),addMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:s}=e,n=(0,i.du)(s,"resolved_system_ids");return{method:"POST",url:"/plus/discovery-monitor/".concat(t,"/promote?").concat(n)}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:s}=e,n=(0,i.du)(s,"resolved_system_ids");return{method:"POST",url:"/plus/discovery-monitor/".concat(t,"/mute?").concat(n)}},invalidatesTags:["Discovery Monitor Results"]}),addMonitorResultAssets:e.mutation({query:e=>{var t;let s=new URLSearchParams;return null===(t=e.urnList)||void 0===t||t.forEach(e=>s.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/promote?".concat(s)}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultAssets:e.mutation({query:e=>{var t;let s=new URLSearchParams;return null===(t=e.urnList)||void 0===t||t.forEach(e=>s.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/mute?".concat(s)}},invalidatesTags:["Discovery Monitor Results"]}),updateAssetsSystem:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,user_assigned_system_key:e.systemKey}))}),invalidatesTags:["Discovery Monitor Results","System Assets"]}),updateAssetsDataUse:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,user_assigned_data_uses:e.dataUses}))}),invalidatesTags:["Discovery Monitor Results"]}),updateAssets:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.assets}),invalidatesTags:["Discovery Monitor Results"]})})})},90057:function(e,t,s){"use strict";var n=s(86677),i=s(27378),o=s(62656);let a={ATTENTION_REQUIRED:{index:0,hash:"#attention-required"},RECENT_ACTIVITY:{index:1,hash:"#recent-activity"},IGNORED:{index:2,hash:"#ignored"}},r=e=>{let t=e.startsWith("#")?e:"#".concat(e);return Object.values(a).find(e=>e.hash===t)},l=e=>Object.values(a).find(t=>t.index===e);t.Z=e=>{var t;let{systemId:s,initialHash:d}=e,c=(0,n.useRouter)(),[u,m]=(0,i.useState)(d?null===(t=r(d))||void 0===t?void 0:t.index:a.ATTENTION_REQUIRED.index),g=(0,i.useCallback)(async e=>{if(m(e),c.isReady){let t=l(e);if(t){let e={...c.query};await c.replace({pathname:c.pathname,query:e,hash:t.hash},void 0,{shallow:!0})}}},[c]),h=[{label:"Attention required",params:{diff_status:[o.LL.ADDITION],system:s}},{label:"Recent activity",params:{diff_status:[o.LL.MONITORED]}},{label:"Ignored",params:{diff_status:[o.LL.MUTED],system:s}}],{diff_status:v,system:y}=h[u].params,p=v.includes(o.LL.MONITORED);return{filterTabs:h,filterTabIndex:u,onTabChange:g,activeParams:s?{diff_status:v,system:y}:{diff_status:v},actionsDisabled:p}}},56839:function(e,t,s){"use strict";s.d(t,{dK:function(){return c},Rv:function(){return g},$P:function(){return m},zj:function(){return h},Kr:function(){return v},q1:function(){return u},QL:function(){return y}});var n=s(24246),i=s(77181);let o=(0,i.IUT)({displayName:"CircleIcon",viewBox:"0 0 200 200",path:(0,n.jsx)("path",{fill:"currentColor",d:"M 100, 100 m -75, 0 a 75,75 0 1,0 150,0 a 75,75 0 1,0 -150,0"})}),a=(0,i.IUT)({displayName:"RightDownArrowIcon",viewBox:"0 0 8 8",path:(0,n.jsx)("path",{fill:"currentColor",d:"M7.23192 8H8V7.23192V1.85539V1.08731H6.46385V1.85539V5.37654L1.62976 0.544855L1.08731 0L0 1.08731L0.542454 1.62976L5.37654 6.46385H1.85539H1.08731V8H1.85539H7.23192Z"})}),r=(0,i.IUT)({displayName:"RightUpArrowIcon",viewBox:"0 0 8 8",path:(0,n.jsx)("path",{fill:"currentColor",d:"M7.23192 0H8V0.768077V6.14461V6.91269H6.46385V6.14461V2.62346L1.62976 7.45515L1.08731 8L0 6.91269L0.542454 6.37024L5.37654 1.53615H1.85539H1.08731V0H1.85539H7.23192Z"})}),l=(0,i.IUT)({displayName:"TagIcon",viewBox:"0 0 9 10",path:(0,n.jsx)("path",{fill:"currentColor",d:"M0 0.5V5L4.5 9.5L9 5L4.5 0.5H0ZM2.25 2.10714C2.4205 2.10714 2.58401 2.17487 2.70457 2.29543C2.82513 2.41599 2.89286 2.5795 2.89286 2.75C2.89286 2.9205 2.82513 3.08401 2.70457 3.20457C2.58401 3.32513 2.4205 3.39286 2.25 3.39286C2.0795 3.39286 1.91599 3.32513 1.79543 3.20457C1.67487 3.08401 1.60714 2.9205 1.60714 2.75C1.60714 2.5795 1.67487 2.41599 1.79543 2.29543C1.91599 2.17487 2.0795 2.10714 2.25 2.10714Z"})});var d=s(28278);let c=()=>(0,n.jsx)(r,{color:"green.400",boxSize:2,mr:2,"data-testid":"add-icon"}),u=()=>(0,n.jsx)(a,{color:"red.400",boxSize:2,mr:2,"data-testid":"remove-icon"}),m=()=>(0,n.jsx)(l,{color:"orange.400",boxSize:3,mr:1,"data-testid":"classify-icon"}),g=()=>(0,n.jsx)(o,{color:"blue.400",boxSize:2.5,mb:"2px",mr:"6px","data-testid":"change-icon"}),h=()=>(0,n.jsx)(o,{color:"green.400",boxSize:2,mr:2,"data-testid":"monitored-icon"}),v=()=>(0,n.jsx)(o,{color:"red.400",boxSize:2,mr:2,"data-testid":"muted-icon"}),y={[d.E.ADDITION]:(0,n.jsx)(c,{}),[d.E.REMOVAL]:(0,n.jsx)(u,{}),[d.E.CLASSIFICATION]:(0,n.jsx)(m,{}),[d.E.CHANGE]:(0,n.jsx)(g,{}),[d.E.MONITORED]:(0,n.jsx)(h,{}),[d.E.MUTED]:(0,n.jsx)(v,{}),[d.E.IN_PROGRESS]:(0,n.jsx)(()=>(0,n.jsx)(o,{color:"orange.400",boxSize:2,mr:2,"data-testid":"in-progress-icon"}),{}),[d.E.NONE]:null}},28278:function(e,t,s){"use strict";var n,i;s.d(t,{E:function(){return n}}),(i=n||(n={})).ADDITION="Addition",i.CHANGE="Change",i.REMOVAL="Removal",i.CLASSIFICATION="Classification",i.IN_PROGRESS="Classifying",i.MONITORED="Monitoring",i.MUTED="Unmonitored",i.NONE="--"},56856:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return A}});var n=s(24246),i=s(86677),o=s(35287),a=s(77830),r=s(58754),l=s(59003),d=s(92222),c=s(77181),u=s(27378),m=s(66379),g=s(812),h=s(14047),v=s(14481),y=s(37059),p=s(90057),f=s(62656),x=s(31883),j=s(57454),_=s(8411),b=s(72625),w=s(34929),C=s(78238),R=e=>{var t,s;let{system:i}=e,{getDataUseDisplayName:o}=(0,w.Z)(),a=(null!==(s=null===(t=i.data_uses)||void 0===t?void 0:t.filter(e=>(0,C.Z)(e)))&&void 0!==s?s:[]).map(e=>({label:o(e),key:e}));return(0,n.jsx)(b.mb,{values:a})};let I=e=>{let{monitorId:t,system:s,allowIgnore:i}=e,[o,{isLoading:r}]=(0,y.rs)(),[l,{isLoading:d}]=(0,y.nP)(),{successAlert:u,errorAlert:m}=(0,h.V)(),v=r||d,{id:p,name:f,system_key:x,total_updates:j}=s,_=async()=>{let e=await o({monitor_config_key:t,resolved_system_ids:[p]});(0,g.D4)(e)?m((0,g.e$)(e.error)):u(x?"".concat(j," assets from ").concat(f," have been added to the system inventory."):"".concat(f," and ").concat(j," assets have been added to the system inventory. ").concat(f," is now configured for consent."),"Confirmed")},b=async()=>{let e=await l({monitor_config_key:t,resolved_system_ids:[p||a.Kl]});(0,g.D4)(e)?m((0,g.e$)(e.error)):u(f?"".concat(j," assets from ").concat(f," have been ignored and will not appear in future scans."):"".concat(j," uncategorized assets have been ignored and will not appear in future scans."),"Confirmed")};return(0,n.jsxs)(c.vyj,{children:[(0,n.jsx)(c.esZ,{title:s.id?void 0:"These assets must be categorized before you can add them to the inventory.",children:(0,n.jsx)(c.wpx,{"data-testid":"add-btn",size:"small",onClick:_,disabled:!s.id||v,loading:r,children:"Add"})}),i&&(0,n.jsx)(c.wpx,{"data-testid":"ignore-btn",size:"small",onClick:b,disabled:v,loading:d,children:"Ignore"})]})};var T=s(56839);let E=e=>{let{system:t}=e;return(0,n.jsxs)(c.kCb,{alignItems:"center",height:"100%",children:[!(null==t?void 0:t.system_key)&&(0,n.jsx)(c.ua7,{label:"New system",children:(0,n.jsx)("span",{children:T.QL.Change})}),(0,n.jsx)(c.xvT,{fontSize:"xs",fontWeight:"semibold",lineHeight:4,overflow:"hidden",textOverflow:"ellipsis",children:(null==t?void 0:t.name)||"Uncategorized assets"})]})},S=e=>{let{monitorId:t,readonly:s,allowIgnore:i}=e,o=(0,d.Cl)(),a=o.display({id:"select",cell:e=>{let{row:t}=e;return(0,n.jsx)(v.k,{isChecked:t.getIsSelected(),onChange:t.getToggleSelectedHandler(),dataTestId:"select-".concat(t.original.name||t.id)})},header:e=>{let{table:t}=e;return(0,n.jsx)(v.k,{isChecked:t.getIsAllPageRowsSelected(),isIndeterminate:t.getIsSomeRowsSelected(),onChange:t.getToggleAllRowsSelectedHandler(),dataTestId:"select-all-rows"})},maxSize:40,meta:{disableRowClick:!0,cellProps:{borderRight:"none"}}}),r=o.accessor(e=>e.name,{id:"system_name",cell:e=>(0,n.jsx)(E,{system:e.row.original}),header:"System",size:300,meta:{headerProps:{paddingLeft:"0px"},cellProps:{padding:"0 !important"}}}),l=o.accessor(e=>e.total_updates,{id:"total_updates",cell:e=>(0,n.jsx)(v.G3,{value:e.getValue()}),header:"Assets",size:80}),c=o.display({id:"data_use",cell:e=>(0,n.jsx)(R,{system:e.row.original}),header:"Categories of consent",size:400,meta:{disableRowClick:!0}}),m=o.accessor(e=>e.locations,{id:"locations",cell:e=>(0,n.jsx)(b.mb,{values:e.getValue().map(e=>({label:_.Z8[e],key:e}))}),header:"Locations",size:300,meta:{showHeaderMenu:!0,disableRowClick:!0}}),g=o.accessor(e=>e.domains,{id:"domains",cell:e=>(0,n.jsx)(b.tc,{values:e.getValue(),valueSuffix:"domains",cellProps:e}),header:"Domains",meta:{showHeaderMenu:!0,disableRowClick:!0}}),h=o.display({id:"actions",cell:e=>(0,n.jsx)(I,{system:e.row.original,monitorId:t,allowIgnore:i}),header:"Actions",meta:{disableRowClick:!0}}),y=(0,u.useMemo)(()=>[r,l,c,m,g],[r,l,c,m,g]);return s?{columns:y}:{columns:[a,...y,h]}},L=e=>{let{monitorId:t}=e,s=(0,i.useRouter)(),o=s.asPath.split("#")[1],{PAGE_SIZES:r,pageSize:_,setPageSize:b,onPreviousPageClick:w,isPreviousPageDisabled:C,onNextPageClick:R,isNextPageDisabled:I,startRange:T,endRange:E,pageIndex:L,setTotalPages:A,resetPageIndexToDefault:D}=(0,v.oi)(),[k,{isLoading:M}]=(0,y.rs)(),[N,{isLoading:P}]=(0,y.nP)(),{successAlert:O,errorAlert:z}=(0,h.V)(),[H,U]=(0,u.useState)(""),[V,q]=(0,u.useState)({});(0,u.useEffect)(()=>{D()},[t,H,D]);let{filterTabs:Z,filterTabIndex:G,onTabChange:K,activeParams:B,actionsDisabled:W}=(0,p.Z)({initialHash:o}),{data:$,isLoading:Q,isFetching:F}=(0,y.wi)({key:t,page:L,size:_,search:H,...B});(0,u.useEffect)(()=>{$&&A($.pages||1)},[$,A]);let{columns:X}=S({monitorId:t,readonly:W,allowIgnore:!B.diff_status.includes(f.LL.MUTED)}),J=(0,l.b7)({getCoreRowModel:(0,d.sC)(),columns:X,manualPagination:!0,data:(null==$?void 0:$.items)||[],columnResizeMode:"onChange",onRowSelectionChange:q,state:{rowSelection:V}}),Y=J.getSelectedRowModel().rows,ee=Y.some(e=>null===e.original.id);if(Q)return(0,n.jsx)(v.I4,{rowHeight:36,numRows:36});let et=async()=>{let e=Y.reduce((e,t)=>e+t.original.total_updates,0),s=await k({monitor_config_key:t,resolved_system_ids:Y.map(e=>e.original.id)});(0,x.D4)(s)?z((0,g.e$)(s.error)):(O("".concat(e," assets have been added to the system inventory.")),q({}))},es=async()=>{let e=Y.reduce((e,t)=>e+t.original.total_updates,0),s=await N({monitor_config_key:t,resolved_system_ids:Y.map(e=>{var t;return null!==(t=e.original.id)&&void 0!==t?t:a.Kl})});(0,x.D4)(s)?z((0,g.e$)(s.error)):(O("".concat(e," assets have been ignored and will not appear in future scans.")),q({}))};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.Z,{data:Z,"data-testid":"filter-tabs",index:G,isLazy:!0,isManual:!0,onChange:e=>{K(e),q({})}}),(0,n.jsx)(v.Q$,{children:(0,n.jsxs)(c.kCb,{direction:"row",alignItems:"center",justifyContent:"space-between",width:"full",children:[(0,n.jsx)(c.kCb,{gap:6,align:"center",children:(0,n.jsx)(c.xuv,{flexShrink:0,children:(0,n.jsx)(j.M,{value:H,onChange:U})})}),(0,n.jsxs)(c.kCb,{align:"center",children:[!!Y.length&&(0,n.jsx)(c.xvT,{fontSize:"xs",fontWeight:"semibold",minW:16,mr:6,"data-testid":"selected-count",children:"".concat(Y.length," selected")}),(0,n.jsxs)(c.v2r,{children:[(0,n.jsx)(c.j2t,{as:c.wpx,icon:(0,n.jsx)(c.PJP._ME,{}),iconPosition:"end",loading:M||P,"data-testid":"bulk-actions-menu",disabled:!Y.length,type:"primary",children:"Actions"}),(0,n.jsxs)(c.qyq,{children:[(0,n.jsx)(c.esZ,{title:ee?"Uncategorized assets can't be added to the inventory":null,placement:"left",children:(0,n.jsx)(c.sNh,{fontSize:"small",onClick:et,"data-testid":"bulk-add",isDisabled:ee,children:"Add"})}),!B.diff_status.includes(f.LL.MUTED)&&(0,n.jsx)(c.sNh,{fontSize:"small",onClick:es,"data-testid":"bulk-ignore",children:"Ignore"})]})]})]})]})}),(0,n.jsx)(v.ZK,{tableInstance:J,onRowClick:e=>{var n;let i="".concat(a.vi,"/").concat(t,"/").concat(null!==(n=e.id)&&void 0!==n?n:a.Kl).concat(o?"#".concat(o):"");s.push(i)},emptyTableNotice:(0,n.jsx)(c.oj8,{image:c.oj8.PRESENTED_IMAGE_SIMPLE,description:"All caught up!"})}),(0,n.jsx)(v.s8,{totalRows:(null==$?void 0:$.total)||0,pageSizes:r,setPageSize:b,onPreviousPageClick:w,isPreviousPageDisabled:C||F,onNextPageClick:R,isNextPageDisabled:I||F,startRange:T,endRange:E})]})};var A=()=>{let e=decodeURIComponent((0,i.useRouter)().query.monitorId);return(0,n.jsxs)(o.Z,{title:"Action center - Discovered assets by system",children:[(0,n.jsx)(r.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:a.vi},{title:e}]}),(0,n.jsx)(L,{monitorId:e})]})}},31883:function(e,t,s){"use strict";s.d(t,{Bw:function(){return n.Bw},D4:function(){return n.D4}});var n=s(19043)}},function(e){e.O(0,[8033,6060,2858,2866,9278,4481,6395,146,2888,9774,179],function(){return e(e.s=86850)}),_N_E=e.O()}]);