{% extends "layout.html" %}

{% block extra_header %}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/base16/ashes.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js"></script>
{% endblock %}

{% block title %}Node{% endblock %}

{% block content %}
  <h2>Node</h2>
  <div class="accordion" id="accordion">
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInfo" aria-expanded="true" aria-controls="collapseInfo">
          Info
        </button>
      </h2>
      <div id="collapseInfo" class="accordion-collapse collapse show" data-bs-parent="#accordion">
        <div class="accordion-body">
          <table class="table table-striped table-bordered">
            <thead>
              <tr>
                <th>Dag</th>
                <th>Node</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><a href="{{ dag_link }}">{{ dag_id }}</a></td>
                <td>{{ node_id }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseData" aria-expanded="false" aria-controls="collapseData">
          Data
        </button>
      </h2>
      <div id="collapseData" class="accordion-collapse collapse" data-bs-parent="#accordion">
        <div class="accordion-body">
          <pre><code class="language-python">{{ value }}</code></pre>
        </div>
      </div>
    </div>
    {% if script %}
      <div class="accordion-item">
        <h2 class="accordion-header">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCode" aria-expanded="false" aria-controls="collapseCode">
            Code
          </button>
        </h2>
        <div id="collapseCode" class="accordion-collapse collapse" data-bs-parent="#accordion">
          <div class="accordion-body">
            <pre><code class="language-python">{{ script }}</code></pre>
          </div>
        </div>
      </div>
    {% endif %}
    {% if stack_trace %}
      <div class="accordion-item">
        <h2 class="accordion-header">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseStactrace" aria-expanded="false" aria-controls="collapseStactrace">
            Stacktrace
          </button>
        </h2>
        <div id="collapseStactrace" class="accordion-collapse collapse" data-bs-parent="#accordion">
          <div class="accordion-body">
            <pre><code class="language-python">{{ stack_trace }}</code></pre>
          </div>
        </div>
      </div>
    {% endif %}
    {% if html_uri %}
      <div class="accordion-item">
        <h2 class="accordion-header">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCode" aria-expanded="false" aria-controls="collapseCode">
            HTML
          </button>
        </h2>
        <div id="collapseCode" class="accordion-collapse collapse" data-bs-parent="#accordion">
          <div class="accordion-body">
            <iframe src="{{ html_uri }}"
                    style="width: 100%; height: 100vh; border: none;" 
                    sandbox="allow-scripts allow-same-origin"></iframe>
          </div>
        </div>
      </div>
    {% endif %}
  </div>
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    hljs.highlightAll();
  });
  </script>
{% endblock %}
