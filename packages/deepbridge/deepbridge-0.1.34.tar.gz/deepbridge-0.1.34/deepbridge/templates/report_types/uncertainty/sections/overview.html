<!-- overview.html - Overview section of the uncertainty report -->
{% extends "../components/widgets/tab_navigation.html" %}

{% block tab_content %}
<div class="overview-section">
    <div class="card">
        <h2>Overview</h2>
        <p>This overview provides a high-level assessment of the model's uncertainty quantification quality, focusing on coverage, calibration, and sharpness.</p>
        
        <!-- Summary Components -->
        <div class="overview-summary">
            {% include "../components/summary/summary_overview.html" %}
        </div>
        
        <!-- Main Overview Charts -->
        {% include "../components/widgets/chart_selector.html" with 
            id="overview_charts_selector"
            options=["Coverage Analysis", "Calibration Curve", "Uncertainty Distribution"]
            activeOption="Coverage Analysis"
            controller="overviewController.switchOverviewChart"
        %}
        
        <div class="overview-charts-container">
            <div id="coverage-analysis-container" class="chart-container active" data-chart-type="coverage-analysis">
                {% include "../components/charts/alpha_coverage_chart.html" %}
            </div>
            
            <div id="calibration-curve-container" class="chart-container" data-chart-type="calibration-curve">
                {% include "../components/charts/calibration_chart.html" %}
            </div>
            
            <div id="uncertainty-distribution-container" class="chart-container" data-chart-type="uncertainty-distribution">
                {% include "../components/charts/uncertainty_distribution_chart.html" %}
            </div>
        </div>
        
        <!-- Key Metrics Section -->
        <div class="key-metrics-section">
            <h3>Key Metrics</h3>
            <div class="metrics-grid">
                <div class="metric-group">
                    <h4>Coverage Metrics</h4>
                    <div class="metric-table">
                        <div class="metric-row">
                            <div class="metric-name">Average Coverage</div>
                            <div class="metric-value">{{ avg_coverage|round(4) }}</div>
                            <div class="metric-status {{ avg_coverage_status }}">{{ avg_coverage_status }}</div>
                        </div>
                        <div class="metric-row">
                            <div class="metric-name">Average Coverage Gap</div>
                            <div class="metric-value">{{ avg_coverage_gap|round(4) }}</div>
                            <div class="metric-status {{ avg_coverage_gap_status }}">{{ avg_coverage_gap_status }}</div>
                        </div>
                        <div class="metric-row">
                            <div class="metric-name">Coverage at 95% CI</div>
                            <div class="metric-value">{{ coverage_95ci|round(4) }}</div>
                            <div class="metric-status {{ coverage_95ci_status }}">{{ coverage_95ci_status }}</div>
                        </div>
                    </div>
                </div>
                
                <div class="metric-group">
                    <h4>Calibration Metrics</h4>
                    <div class="metric-table">
                        <div class="metric-row">
                            <div class="metric-name">Expected Calibration Error</div>
                            <div class="metric-value">{{ calibration_error|round(4) }}</div>
                            <div class="metric-status {{ calibration_error_status }}">{{ calibration_error_status }}</div>
                        </div>
                        <div class="metric-row">
                            <div class="metric-name">Maximum Calibration Error</div>
                            <div class="metric-value">{{ max_calibration_error|round(4) }}</div>
                            <div class="metric-status {{ max_calibration_error_status }}">{{ max_calibration_error_status }}</div>
                        </div>
                        <div class="metric-row">
                            <div class="metric-name">Brier Score</div>
                            <div class="metric-value">{{ brier_score|round(4) }}</div>
                            <div class="metric-status {{ brier_score_status }}">{{ brier_score_status }}</div>
                        </div>
                    </div>
                </div>
                
                <div class="metric-group">
                    <h4>Sharpness Metrics</h4>
                    <div class="metric-table">
                        <div class="metric-row">
                            <div class="metric-name">Average Interval Width</div>
                            <div class="metric-value">{{ avg_interval_width|round(4) }}</div>
                            <div class="metric-status {{ avg_interval_width_status }}">{{ avg_interval_width_status }}</div>
                        </div>
                        <div class="metric-row">
                            <div class="metric-name">Width Coefficient of Variation</div>
                            <div class="metric-value">{{ width_cv|round(4) }}</div>
                            <div class="metric-status {{ width_cv_status }}">{{ width_cv_status }}</div>
                        </div>
                        <div class="metric-row">
                            <div class="metric-name">Interval Efficiency</div>
                            <div class="metric-value">{{ interval_efficiency|round(4) }}</div>
                            <div class="metric-status {{ interval_efficiency_status }}">{{ interval_efficiency_status }}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Uncertainty Distribution Analysis -->
        <div class="uncertainty-distribution-section">
            <h3>Uncertainty Distribution Analysis</h3>
            <p>This analysis examines the distribution of uncertainty across predictions and its relationship to model errors.</p>
            
            <div class="uncertainty-charts">
                <div class="chart-pair">
                    <div class="chart-container half-width">
                        <h4>Uncertainty Distribution</h4>
                        <div id="uncertainty-histogram" class="chart-plot"></div>
                    </div>
                    <div class="chart-container half-width">
                        <h4>Uncertainty vs. Error</h4>
                        <div id="uncertainty-error-plot" class="chart-plot"></div>
                    </div>
                </div>
            </div>
            
            <div class="uncertainty-insights">
                <h4>Key Insights</h4>
                <ul class="insights-list">
                    {% for insight in uncertainty_insights %}
                    <li class="insight-item">{{ insight }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        
        <!-- Recommendations Section -->
        <div class="recommendations-section">
            <h3>Recommendations</h3>
            
            <div class="recommendation-cards">
                {% for recommendation in recommendations %}
                <div class="recommendation-card {{ recommendation.priority }}">
                    <div class="recommendation-header">
                        <div class="recommendation-icon">{{ recommendation.icon }}</div>
                        <h4 class="recommendation-title">{{ recommendation.title }}</h4>
                        <div class="recommendation-priority-badge">{{ recommendation.priority }}</div>
                    </div>
                    <div class="recommendation-content">
                        <p>{{ recommendation.description }}</p>
                    </div>
                    <div class="recommendation-actions">
                        {% if recommendation.actions %}
                        <div class="actions-list">
                            {% for action in recommendation.actions %}
                            <div class="action-item">
                                <div class="action-icon">â–¶</div>
                                <div class="action-text">{{ action }}</div>
                            </div>
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}