<!-- feature_impact_table.html - placeholder -->
<!-- feature_impact_table.html - Feature impact analysis table -->
<div class="feature-impact-table-container">
    <div class="table-info">
        <p>This table analyzes how distribution shifts in each feature impact model performance.</p>
    </div>

    <div class="table-controls">
        <div class="search-filter">
            <input type="text" id="feature-search-impact" class="feature-search" placeholder="Search features...">
        </div>
        
        <div class="sorting-control">
            <label for="sort-by-impact">Sort by:</label>
            <select id="sort-by-impact" class="sort-selector">
                <option value="resilience_impact" selected>Resilience Impact (High to Low)</option>
                <option value="shift_magnitude">Shift Magnitude (High to Low)</option>
                <option value="importance">Feature Importance (High to Low)</option>
                <option value="feature">Feature Name (A-Z)</option>
            </select>
        </div>
        
        <div class="display-control">
            <label for="rows-display-impact">Show:</label>
            <select id="rows-display-impact" class="rows-selector">
                <option value="10">10 rows</option>
                <option value="25" selected>25 rows</option>
                <option value="50">50 rows</option>
                <option value="all">All rows</option>
            </select>
        </div>
    </div>

    <div class="table-wrapper">
        <table class="data-table feature-impact-table" id="feature-impact-table">
            <thead>
                <tr>
                    <th class="feature-col sortable" data-sort="feature">Feature</th>
                    <th class="type-col sortable" data-sort="type">Type</th>
                    <th class="importance-col sortable" data-sort="importance">Feature Importance</th>
                    <th class="shift-magnitude-col sortable" data-sort="shift">Shift Magnitude</th>
                    <th class="performance-impact-col sortable" data-sort="impact">Performance Impact</th>
                    <th class="resilience-impact-col sortable" data-sort="resilience_impact">Resilience Impact</th>
                    <th class="sensitivity-col sortable" data-sort="sensitivity">Shift Sensitivity</th>
                </tr>
            </thead>
            <tbody>
                {% if sensitive_features is defined and sensitive_features|length > 0 %}
                    <!-- Table rows will be populated by JavaScript -->
                    <tr class="loading-row">
                        <td colspan="7">
                            <div class="loading-indicator">Loading feature impact data...</div>
                        </td>
                    </tr>
                {% else %}
                    <!-- No data available message -->
                    <tr class="no-data-row">
                        <td colspan="7">
                            <div class="no-data-message">Data not available from test results</div>
                        </td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>

    <div class="table-pagination">
        <div class="pagination-controls">
            <button class="pagination-btn" id="prev-page-impact" disabled>&laquo; Previous</button>
            <span class="pagination-info" id="pagination-info-impact">Page 1 of 1</span>
            <button class="pagination-btn" id="next-page-impact" disabled>Next &raquo;</button>
        </div>
    </div>

    <div class="feature-impact-explanation">
        <h4>Understanding Feature Impact Metrics</h4>
        <div class="explanation-grid">
            <div class="explanation-item">
                <div class="metric-name">Feature Importance</div>
                <div class="metric-description">The importance of the feature to the model's predictions, derived from the model's internal metrics or from permutation importance.</div>
            </div>
            <div class="explanation-item">
                <div class="metric-name">Shift Magnitude</div>
                <div class="metric-description">How much the feature's distribution has changed between baseline and target datasets, measured using statistical distance metrics.</div>
            </div>
            <div class="explanation-item">
                <div class="metric-name">Performance Impact</div>
                <div class="metric-description">The direct impact on model performance when this feature's distribution shifts, holding other features constant.</div>
            </div>
            <div class="explanation-item">
                <div class="metric-name">Resilience Impact</div>
                <div class="metric-description">The overall contribution of this feature to resilience issues, combining importance, shift magnitude, and performance impact.</div>
            </div>
            <div class="explanation-item">
                <div class="metric-name">Shift Sensitivity</div>
                <div class="metric-description">How sensitive the model's predictions are to shifts in this feature's distribution, normalized across features.</div>
            </div>
        </div>
    </div>

    <div class="table-actions">
        <div class="action-buttons">
            <button class="action-button" id="show-critical-features">Show Critical Features Only</button>
            <button class="action-button" id="export-feature-impact">Export Data</button>
        </div>
    </div>

    <div class="table-notes">
        <div class="note-item">
            <span class="note-icon">⚠️</span>
            <span class="note-text">
                Features highlighted in red have high resilience impact and should be prioritized for mitigation strategies.
            </span>
        </div>
    </div>
</div>