Metadata-Version: 2.4
Name: StellarPolAnalyzer
Version: 0.1.14
Summary: LibrerÃ­a para anÃ¡lisis de imÃ¡genes polarimÃ©tricas y detecciÃ³n de parejas de estrellas
Home-page: https://github.com/oscarmellizo/StellarPolAnalyzer
Author: Oscar Mellizo Angulo
Author-email: omellizo@gmail.com
License: Apache License 2.0
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: Apache Software License
Classifier: Operating System :: OS Independent
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: numpy
Requires-Dist: matplotlib
Requires-Dist: astropy
Requires-Dist: photutils
Requires-Dist: scikit-learn
Requires-Dist: scikit-image
Requires-Dist: scipy
Requires-Dist: astroquery
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: license
Dynamic: license-file
Dynamic: requires-dist
Dynamic: summary

# ğŸŒŸ StellarPolAnalyzer

**_Empareja, fotometriza y astrometriza imÃ¡genes polarimÃ©tricas de campo estelar en un solo flujo._**

----

## ğŸ“š DescripciÃ³n

StellarPolAnalyzer es una **librerÃ­a Python** que automatiza todo el **pipeline polarimÃ©trico** en imÃ¡genes astronÃ³micas:

1. **DetecciÃ³n** de estrellas con DAOStarFinder.
2. **Emparejado** de componentes ordinaria/extraordinaria (beam splitter).
3. **FotometrÃ­a** de apertura en 4 Ã¡ngulos de polarizaciÃ³n.
4. CÃ¡lculo de parÃ¡metros de polarizaciÃ³n: **Q, U, P, Î¸** y errores.
5. **AlineaciÃ³n** de imÃ¡genes (phase cross-correlation).
6. **GeneraciÃ³n de imagen sintÃ©tica** y soluciÃ³n WCS con Astrometry.Net.
7. **Cruce SIMBAD** para identificar objetos celestes.
8. **VisualizaciÃ³n** clara de pares, aperturas y resultados.
9. **Reporte rÃ¡pido** vÃ­a funciones modulares o pipeline completo.

Ideal para tus proyectos de **TFM**, exoplanetas, discos circumestelares o estudios de polarizaciÃ³n galÃ¡ctica.

----

## ğŸš€ InstalaciÃ³n

```bash
pip install StellarPolAnalyzer
```

> Requiere Python â‰¥3.7 y dependencias:
> `numpy`, `astropy`, `photutils`, `scikit-learn`, `scikit-image`, `scipy`, `astroquery`, `matplotlib`.

----

## ğŸ“ Estructura del paquete

```text
StellarPolAnalyzer/
â”œâ”€ alignment.py        # AlineaciÃ³n FITS y guardado
â”œâ”€ detection.py        # DetecciÃ³n de fuentes y process_image
â”œâ”€ pairing.py          # CÃ¡lculo de distancias/Ã¡ngulos y emparejado
â”œâ”€ photometry.py       # Aperture photometry y polarimetrÃ­a
â”œâ”€ astrometry.py       # Imagen sintÃ©tica, Astrometry.Net y SIMBAD
â”œâ”€ visualization.py    # Funciones de dibujo y resumen
â”œâ”€ pipeline.py         # compute_full_polarimetry + run_complete_pipeline
â”œâ”€ utils.py            # Utilidades (exportar pares)
â””â”€ __init__.py         # API pÃºblica
```

----

## ğŸ› ï¸ Uso detallado

### 1ï¸âƒ£  DetecciÃ³n y emparejado bÃ¡sico

```python
from StellarPolAnalyzer.detection import process_image
from StellarPolAnalyzer.visualization import draw_pairs

# 1. Procesar una imagen FITS (p.ej. 0Â°)
img_path = 'data/field_0.fits'
data, sources, cands, pairs, d_mode, a_mode = process_image(
    img_path,
    fwhm=3.0,
    threshold_multiplier=5.0,
    tol_distance=1.44,
    tol_angle=1.20,
    max_distance=75
)

# 2. Visualizar resultados
draw_pairs(
    image_data=data,
    sources=sources,
    pairs=pairs,
    num_stars=len(sources),
    mode_distance=d_mode,
    mode_angle=a_mode,
    tol_distance=1.44,
    tol_angle=1.20
)
```

> ğŸ” **Salida**: grÃ¡fico con puntos rojos (estrella), lÃ­neas lime (parejas), cÃ­rculos azules/rojos y resumen.

----

### 2ï¸âƒ£ Pipeline completo de polarimetrÃ­a + astrometrÃ­a

```python
from StellarPolAnalyzer.pipeline import run_complete_polarimetric_pipeline
import astropy.units as u

# Definir paths y Ã¡ngulos
ref = 'data/field_0.fits'
others = ['data/field_22.fits', 'data/field_45.fits', 'data/field_67.fits']
angles = [0.0, 22.5, 45.0, 67.5]

# Ejecutar flujo completo
final_paths, polar_results, wcs, enriched = \
    run_complete_polarimetric_pipeline(
        ref_path=ref,
        other_paths=others,
        pol_angles=angles,
        fwhm=3.0,
        threshold_multiplier=5.0,
        tol_distance=1.44,
        tol_angle=1.20,
        max_distance=75,
        phot_aperture_radius=5,
        r_in=7,
        r_out=10,
        SNR_threshold=5,
        astrometry_api_key='TU_API_KEY',
        simbad_radius=0.01*u.deg,
        synthetic_name='synthetic_field.fits'
    )

# Mostrar resultados bÃ¡sicos
print('Â°Â° ImÃ¡genes procesadas:')
for p in final_paths:
    print(' -', p)

print('\nâ­ PolarimetrÃ­a por par:')
for entry in enriched:
    print(f"Par {entry['pair_index']:02d} -> P={entry['P']:.2f}%  Î¸={entry['theta']:.1f}Â°  SIMBAD={entry['simbad_id']}")
```

> ğŸŒ **Salida**:
> - FITS alineados
> - Lista de dicts con `{pair_index, q, u, P, Î¸, error, ra, dec, simbad_id}`

----

### 3ï¸âƒ£ MÃ©todos individuales

| FunciÃ³n                                    | DescripciÃ³n                                    |
|--------------------------------------------|------------------------------------------------|
| `detect_stars(image_data, fwhm, thr)`      | Detecta fuentes en `image_data`.               |
| `process_image(path, ...)`                 | DetecciÃ³n + emparejado en 1 imagen.            |
| `compute_distance_angle(p1, p2)`          | Distancia y Ã¡ngulo minimal entre 2 puntos.     |
| `find_candidate_pairs(sources, max_dist)`  | Todas las parejas en rango `max_dist`.         |
| `filter_pairs_by_mode(pairs, tol_d, t_a)`  | Filtra por distancia/Ã¡ngulo modal.             |
| `compute_polarimetry_for_pairs(...)`      | FotometrÃ­a + Q/U/P/Î¸ en 4 Ã¡ngulos.             |
| `align_images(ref, img)`                   | Alinear `img` a `ref` via phase_cross_correlation. |
| `save_fits_with_same_headers(...)`         | Guarda FITS conservando metadatos original.    |
| `annotate_with_astrometry_net(...)`        | Imagen sintÃ©tica + WCS + SIMBAD.               |
| `draw_pairs(...)`                          | Visualiza pares y resumen.                     |
| `compute_full_polarimetry(...)`            | Pipeline polarimetrÃ­a (4 imÃ¡genes).            |
| `run_complete_polarimetric_pipeline(...)`  | Pipeline completo + astrometrÃ­a.               |

----

## ğŸ“„ Licencia

LibrerÃ­a **MIT License** â€“ uso libre, modifica y contribuye. ğŸ‘

----

## ğŸ¤ Contribuciones

Â¡Pull requests, issues y estrellas son bienvenidas! ğŸ› ï¸

----

*Â¡Lleva tu anÃ¡lisis polarimÃ©trico un paso mÃ¡s allÃ¡!* âœ¨

