(()=>{var e={};e.id=547,e.ids=[547],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},6761:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(9564).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},15029:(e,t,r)=>{"use strict";r.d(t,{AddShardsetDialog:()=>n});let n=(0,r(18445).registerClientReference)(function(){throw Error("Attempted to call AddShardsetDialog() from the server but AddShardsetDialog is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/hanch/fal/lavender-data/packages/lavender-data-ui/src/app/datasets/[dataset_id]/add-shardset-dialog.tsx","AddShardsetDialog")},15668:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"6066264461ac65ff787923680b0c954a1218ac5144":()=>o});var n=r(61025);r(37133);var s=r(95705),a=r(95806);async function o(e,t){let r=t.get("location"),n=t.get("columnsJson"),o=[];try{o=JSON.parse(n)}catch(e){return{success:!1,error:"Invalid column data"}}if(!r)return{success:!1,error:"Location is required"};if(o.some(e=>""===e.name))return{success:!1,error:"All columns must have a name"};if(o.some(e=>""===e.type))return{success:!1,error:"All columns must have a type"};try{let t=await (await (0,s.K)()).POST("/datasets/{dataset_id}/shardsets",{params:{path:{dataset_id:e}},body:{location:r,columns:o}});if(t.error){let e="Unknown error";return"string"==typeof t.error.detail&&(e=t.error.detail),{success:!1,error:e}}return(0,a.revalidatePath)(`/datasets/${e}`),{success:!0,data:t.data}}catch(e){return{success:!1,error:e instanceof Error?e.message:"An unexpected error occurred"}}}(0,r(51221).D)([o]),(0,n.A)(o,"6066264461ac65ff787923680b0c954a1218ac5144",null)},16159:(e,t,r)=>{e.exports=r(37043).Symbol},16887:(e,t,r)=>{"use strict";r.d(t,{Cf:()=>u,Es:()=>p,L3:()=>f,c7:()=>h,lG:()=>l,rr:()=>x,zM:()=>i});var n=r(59777);r(98580);var s=r(80507),a=r(15019),o=r(53028);function l({...e}){return(0,n.jsx)(s.bL,{"data-slot":"dialog",...e})}function i({...e}){return(0,n.jsx)(s.l9,{"data-slot":"dialog-trigger",...e})}function c({...e}){return(0,n.jsx)(s.ZL,{"data-slot":"dialog-portal",...e})}function d({className:e,...t}){return(0,n.jsx)(s.hJ,{"data-slot":"dialog-overlay",className:(0,o.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",e),...t})}function u({className:e,children:t,...r}){return(0,n.jsxs)(c,{"data-slot":"dialog-portal",children:[(0,n.jsx)(d,{}),(0,n.jsxs)(s.UC,{"data-slot":"dialog-content",className:(0,o.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...r,children:[t,(0,n.jsxs)(s.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,n.jsx)(a.A,{}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function h({className:e,...t}){return(0,n.jsx)("div",{"data-slot":"dialog-header",className:(0,o.cn)("flex flex-col gap-2 text-center sm:text-left",e),...t})}function p({className:e,...t}){return(0,n.jsx)("div",{"data-slot":"dialog-footer",className:(0,o.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function f({className:e,...t}){return(0,n.jsx)(s.hE,{"data-slot":"dialog-title",className:(0,o.cn)("text-lg leading-none font-semibold",e),...t})}function x({className:e,...t}){return(0,n.jsx)(s.VY,{"data-slot":"dialog-description",className:(0,o.cn)("text-muted-foreground text-sm",e),...t})}},17215:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>A});var n=r(76939),s=r(87170),a=r.n(s),o=r(6761),l=r(26616),i=r.n(l),c=r(72864),d=r(62861);r(93294);var u=r(29298);function h({className:e,...t}){return(0,n.jsx)("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:(0,u.cn)("mx-auto flex w-full justify-center",e),...t})}function p({className:e,...t}){return(0,n.jsx)("ul",{"data-slot":"pagination-content",className:(0,u.cn)("flex flex-row items-center gap-1",e),...t})}function f({...e}){return(0,n.jsx)("li",{"data-slot":"pagination-item",...e})}function x({className:e,isActive:t,size:r="icon",...s}){return(0,n.jsx)(a(),{"aria-current":t?"page":void 0,"data-slot":"pagination-link","data-active":t,className:(0,u.cn)((0,c.r)({variant:t?"outline":"ghost",size:r}),e),...s})}let m=(0,r(9564).A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);function v({centerButtonCount:e,totalPages:t,currentPage:r,pageHref:s}){let a=Math.max(0,Math.min(r-Math.floor(e/2),t-e)),o=Math.min(t,a+e),l=Array.from({length:o-a},(e,t)=>a+t);return(0,n.jsx)(h,{children:(0,n.jsxs)(p,{children:[a>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f,{children:(0,n.jsx)(x,{href:s(0),children:"1"})}),(0,n.jsx)(f,{children:(0,n.jsx)(m,{className:"w-4"})})]}),l.map(e=>(0,n.jsx)(f,{children:(0,n.jsx)(x,{href:s(e),isActive:r===e,children:e+1})},e)),t>o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f,{children:(0,n.jsx)(m,{className:"w-4"})}),(0,n.jsx)(f,{children:(0,n.jsx)(x,{href:s(t-1),children:t})})]})]})})}var g=r(35848),j=r(15029),b=r(83203),w=r(67519),y=r(82688),S=r(65479);function C({shardset:e}){return e?(0,n.jsxs)("div",{children:[(0,n.jsx)(a(),{href:`/datasets/${e.dataset_id}/shardsets/${e.id}`,children:(0,n.jsx)("div",{children:e.id})}),(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:e.location}),(0,n.jsxs)("div",{className:"text-xs text-muted-foreground",children:["total ",e.total_samples," samples, ",e.shard_count," shards"]})]}):(0,n.jsx)("div",{children:"-"})}async function N({dataset_id:e,preview_page:t}){let r=(await (await (0,g.K)()).GET("/datasets/{dataset_id}/preview",{params:{path:{dataset_id:e},query:{offset:Number(t)*T,limit:T}}})).data;if(!r)return(0,n.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"text-lg",children:"Preview"}),(0,n.jsx)(w.ErrorCard,{error:"Preview is not available for this dataset."})]});let s=Math.ceil(r.total/T),a=Number(t);return(0,n.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"text-lg",children:"Preview"}),(0,n.jsxs)(S.Zp,{className:"w-full",children:[(0,n.jsx)(S.Wu,{children:(0,n.jsxs)(d.XI,{children:[(0,n.jsx)(d.A0,{children:(0,n.jsx)(d.Hj,{children:r.columns.map(e=>(0,n.jsx)(d.nd,{children:e.name},e.id))})}),(0,n.jsx)(d.BF,{children:r.samples.map((e,t)=>(0,n.jsx)(d.Hj,{children:r.columns.map(t=>{let r;let s=e[t.name],a=null;return"object"==typeof s&&null!==s?r=JSON.stringify(s):"number"==typeof s?i()(s)?r=String(s):(r=s.toFixed(8),a=s.toFixed(2)):r=String(s),r.length>50&&(a=r.slice(0,50)+"..."),(0,n.jsx)(d.nA,{children:a?(0,n.jsxs)(y.Tooltip,{children:[(0,n.jsx)(y.TooltipTrigger,{asChild:!0,children:(0,n.jsx)("div",{children:a})}),(0,n.jsx)(y.TooltipContent,{children:r})]}):(0,n.jsx)("div",{children:r})},t.id)})},`preview-sample-${t}`))})]})}),(0,n.jsx)(S.wL,{className:"w-full flex justify-center",children:(0,n.jsx)(v,{centerButtonCount:5,totalPages:s,currentPage:a,pageHref:t=>`/datasets/${e}?preview_page=${t}`})})]})]})}let T=10;async function A({params:e,searchParams:t}){let{dataset_id:r}=await e,{preview_page:s=0}=await t,l=await (0,g.K)(),i=await l.GET("/datasets/{dataset_id}",{params:{path:{dataset_id:r}}}),u=await l.GET("/iterations/",{params:{query:{dataset_id:r}}});if(i.error)return(0,n.jsx)(w.ErrorCard,{error:i.error.detail});if(u.error)return(0,n.jsx)(w.ErrorCard,{error:u.error.detail});let h=i.data,p=u.data;return(0,n.jsxs)("main",{className:"container flex w-full flex-1 flex-col items-center justify-center space-y-8 py-10",children:[(0,n.jsxs)("div",{className:"w-full flex flex-col gap-1",children:[(0,n.jsx)("div",{className:"text-lg",children:h.name}),(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:h.id})]}),(0,n.jsx)(N,{dataset_id:r,preview_page:s}),(0,n.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"text-lg",children:"Columns"}),(0,n.jsx)(S.Zp,{className:"w-full",children:(0,n.jsx)(S.Wu,{children:(0,n.jsxs)(d.XI,{children:[(0,n.jsx)(d.A0,{children:(0,n.jsxs)(d.Hj,{children:[(0,n.jsx)(d.nd,{className:"w-[100px]",children:"Name"}),(0,n.jsx)(d.nd,{children:"Type"}),(0,n.jsx)(d.nd,{children:"Description"}),(0,n.jsx)(d.nd,{children:"Shardset"})]})}),(0,n.jsxs)(d.BF,{children:[(0,n.jsxs)(d.Hj,{children:[(0,n.jsx)(d.nA,{children:h.uid_column_name}),(0,n.jsx)(d.nA,{children:"-"}),(0,n.jsx)(d.nA,{children:"Unique identifier for each sample"}),(0,n.jsx)(d.nA,{children:"-"})]}),h.columns.filter(e=>e.name!==h.uid_column_name).map(e=>(0,n.jsxs)(d.Hj,{children:[(0,n.jsx)(d.nA,{children:e.name}),(0,n.jsx)(d.nA,{children:e.type}),(0,n.jsx)(d.nA,{children:e.description}),(0,n.jsx)(d.nA,{children:(0,n.jsx)(C,{shardset:h.shardsets.find(t=>t.id===e.shardset_id)})})]},e.id))]})]})})}),(0,n.jsx)("div",{className:"w-full flex justify-end",children:(0,n.jsx)(j.AddShardsetDialog,{datasetId:r,children:(0,n.jsxs)(c.$,{variant:"outline",children:[(0,n.jsx)(o.A,{}),"Shardset"]})})})]}),(0,n.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"text-lg",children:"Iterations"}),(0,n.jsx)(S.Zp,{className:"w-full",children:(0,n.jsx)(S.Wu,{children:(0,n.jsxs)(d.XI,{children:[(0,n.jsx)(d.A0,{children:(0,n.jsxs)(d.Hj,{children:[(0,n.jsx)(d.nd,{children:"ID"}),(0,n.jsx)(d.nd,{children:"Total"}),(0,n.jsx)(d.nd,{children:"Config"}),(0,n.jsx)(d.nd,{children:"Created"})]})}),(0,n.jsx)(d.BF,{children:p.map(e=>(0,n.jsxs)(d.Hj,{children:[(0,n.jsx)(d.nA,{className:"font-mono text-xs",children:(0,n.jsx)(a(),{href:`/iterations/${e.id}`,children:e.id})}),(0,n.jsx)(d.nA,{children:(0,n.jsx)("div",{children:e.total})}),(0,n.jsxs)(d.nA,{className:"text-xs text-muted-foreground",children:[e.shuffle?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:["Shuffle seed: ",e.shuffle_seed]}),(0,n.jsxs)("div",{children:["Shuffle block size: ",e.shuffle_block_size]})]}):(0,n.jsx)("div",{children:"No shuffle"}),e.batch_size>0?(0,n.jsxs)("div",{children:["Batch size: ",e.batch_size]}):(0,n.jsx)("div",{children:"No batch"}),e.replication_pg?(0,n.jsx)("div",{children:(0,n.jsxs)("div",{children:[e.replication_pg.length," pgs,"," ",e.replication_pg.reduce((e,t)=>e+t.length,0)," ","ranks"]})}):(0,n.jsx)("div",{children:"No replication"})]}),(0,n.jsx)(d.nA,{children:(0,b.v)(e.created_at)})]},e.id))})]})})})]})]})}},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20638:(e,t,r)=>{var n=r(67202),s=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(s,""):e}},21536:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},21683:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},21932:(e,t,r)=>{var n=r(20638),s=r(21683),a=r(59824),o=0/0,l=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,c=/^0o[0-7]+$/i,d=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(a(e))return o;if(s(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=s(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=i.test(e);return r||c.test(e)?d(e.slice(2),r?2:8):l.test(e)?o:+e}},26616:(e,t,r)=>{var n=r(28231);e.exports=function(e){return"number"==typeof e&&e==n(e)}},28231:(e,t,r)=>{var n=r(96230);e.exports=function(e){var t=n(e),r=t%1;return t==t?r?t-r:t:0}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34520:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,9452,23)),Promise.resolve().then(r.bind(r,57891)),Promise.resolve().then(r.bind(r,36493)),Promise.resolve().then(r.bind(r,55386))},37043:(e,t,r)=>{var n=r(58622),s="object"==typeof self&&self&&self.Object===Object&&self;e.exports=n||s||Function("return this")()},57891:(e,t,r)=>{"use strict";r.d(t,{AddShardsetDialog:()=>eu});var n=r(59777),s=r(98580),a=r(84206);let o=(0,a.A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),l=(0,a.A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var i=r(96114),c=r(87813),d=r(23979),u=r(35378),h=r(3205),p=r(74127),f=r(22532),x=s.createContext(void 0),m=r(16002),v=r(76632),g="ScrollArea",[j,b]=(0,h.A)(g),[w,y]=j(g),S=s.forwardRef((e,t)=>{let{__scopeScrollArea:r,type:a="hover",dir:o,scrollHideDelay:l=600,...i}=e,[c,u]=s.useState(null),[h,f]=s.useState(null),[m,v]=s.useState(null),[g,j]=s.useState(null),[b,y]=s.useState(null),[S,C]=s.useState(0),[N,T]=s.useState(0),[A,_]=s.useState(!1),[P,E]=s.useState(!1),R=(0,p.s)(t,e=>u(e)),k=function(e){let t=s.useContext(x);return e||t||"ltr"}(o);return(0,n.jsx)(w,{scope:r,type:a,dir:k,scrollHideDelay:l,scrollArea:c,viewport:h,onViewportChange:f,content:m,onContentChange:v,scrollbarX:g,onScrollbarXChange:j,scrollbarXEnabled:A,onScrollbarXEnabledChange:_,scrollbarY:b,onScrollbarYChange:y,scrollbarYEnabled:P,onScrollbarYEnabledChange:E,onCornerWidthChange:C,onCornerHeightChange:T,children:(0,n.jsx)(d.sG.div,{dir:k,...i,ref:R,style:{position:"relative","--radix-scroll-area-corner-width":S+"px","--radix-scroll-area-corner-height":N+"px",...e.style}})})});S.displayName=g;var C="ScrollAreaViewport",N=s.forwardRef((e,t)=>{let{__scopeScrollArea:r,children:a,nonce:o,...l}=e,i=y(C,r),c=s.useRef(null),u=(0,p.s)(t,c,i.onViewportChange);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:o}),(0,n.jsx)(d.sG.div,{"data-radix-scroll-area-viewport":"",...l,ref:u,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...e.style},children:(0,n.jsx)("div",{ref:i.onContentChange,style:{minWidth:"100%",display:"table"},children:a})})]})});N.displayName=C;var T="ScrollAreaScrollbar",A=s.forwardRef((e,t)=>{let{forceMount:r,...a}=e,o=y(T,e.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:i}=o,c="horizontal"===e.orientation;return s.useEffect(()=>(c?l(!0):i(!0),()=>{c?l(!1):i(!1)}),[c,l,i]),"hover"===o.type?(0,n.jsx)(_,{...a,ref:t,forceMount:r}):"scroll"===o.type?(0,n.jsx)(P,{...a,ref:t,forceMount:r}):"auto"===o.type?(0,n.jsx)(E,{...a,ref:t,forceMount:r}):"always"===o.type?(0,n.jsx)(R,{...a,ref:t}):null});A.displayName=T;var _=s.forwardRef((e,t)=>{let{forceMount:r,...a}=e,o=y(T,e.__scopeScrollArea),[l,i]=s.useState(!1);return s.useEffect(()=>{let e=o.scrollArea,t=0;if(e){let r=()=>{window.clearTimeout(t),i(!0)},n=()=>{t=window.setTimeout(()=>i(!1),o.scrollHideDelay)};return e.addEventListener("pointerenter",r),e.addEventListener("pointerleave",n),()=>{window.clearTimeout(t),e.removeEventListener("pointerenter",r),e.removeEventListener("pointerleave",n)}}},[o.scrollArea,o.scrollHideDelay]),(0,n.jsx)(u.C,{present:r||l,children:(0,n.jsx)(E,{"data-state":l?"visible":"hidden",...a,ref:t})})}),P=s.forwardRef((e,t)=>{var r;let{forceMount:a,...o}=e,l=y(T,e.__scopeScrollArea),i="horizontal"===e.orientation,c=J(()=>h("SCROLL_END"),100),[d,h]=(r={hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}},s.useReducer((e,t)=>r[e][t]??e,"hidden"));return s.useEffect(()=>{if("idle"===d){let e=window.setTimeout(()=>h("HIDE"),l.scrollHideDelay);return()=>window.clearTimeout(e)}},[d,l.scrollHideDelay,h]),s.useEffect(()=>{let e=l.viewport,t=i?"scrollLeft":"scrollTop";if(e){let r=e[t],n=()=>{let n=e[t];r!==n&&(h("SCROLL"),c()),r=n};return e.addEventListener("scroll",n),()=>e.removeEventListener("scroll",n)}},[l.viewport,i,h,c]),(0,n.jsx)(u.C,{present:a||"hidden"!==d,children:(0,n.jsx)(R,{"data-state":"hidden"===d?"hidden":"visible",...o,ref:t,onPointerEnter:(0,v.m)(e.onPointerEnter,()=>h("POINTER_ENTER")),onPointerLeave:(0,v.m)(e.onPointerLeave,()=>h("POINTER_LEAVE"))})})}),E=s.forwardRef((e,t)=>{let r=y(T,e.__scopeScrollArea),{forceMount:a,...o}=e,[l,i]=s.useState(!1),c="horizontal"===e.orientation,d=J(()=>{if(r.viewport){let e=r.viewport.offsetWidth<r.viewport.scrollWidth,t=r.viewport.offsetHeight<r.viewport.scrollHeight;i(c?e:t)}},10);return V(r.viewport,d),V(r.content,d),(0,n.jsx)(u.C,{present:a||l,children:(0,n.jsx)(R,{"data-state":l?"visible":"hidden",...o,ref:t})})}),R=s.forwardRef((e,t)=>{let{orientation:r="vertical",...a}=e,o=y(T,e.__scopeScrollArea),l=s.useRef(null),i=s.useRef(0),[c,d]=s.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=q(c.viewport,c.content),h={...a,sizes:c,onSizesChange:d,hasThumb:!!(u>0&&u<1),onThumbChange:e=>l.current=e,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:e=>i.current=e};function p(e,t){return function(e,t,r,n="ltr"){let s=G(r),a=t||s/2,o=r.scrollbar.paddingStart+a,l=r.scrollbar.size-r.scrollbar.paddingEnd-(s-a),i=r.content-r.viewport;return B([o,l],"ltr"===n?[0,i]:[-1*i,0])(e)}(e,i.current,c,t)}return"horizontal"===r?(0,n.jsx)(k,{...h,ref:t,onThumbPositionChange:()=>{if(o.viewport&&l.current){let e=X(o.viewport.scrollLeft,c,o.dir);l.current.style.transform=`translate3d(${e}px, 0, 0)`}},onWheelScroll:e=>{o.viewport&&(o.viewport.scrollLeft=e)},onDragScroll:e=>{o.viewport&&(o.viewport.scrollLeft=p(e,o.dir))}}):"vertical"===r?(0,n.jsx)(L,{...h,ref:t,onThumbPositionChange:()=>{if(o.viewport&&l.current){let e=X(o.viewport.scrollTop,c);l.current.style.transform=`translate3d(0, ${e}px, 0)`}},onWheelScroll:e=>{o.viewport&&(o.viewport.scrollTop=e)},onDragScroll:e=>{o.viewport&&(o.viewport.scrollTop=p(e))}}):null}),k=s.forwardRef((e,t)=>{let{sizes:r,onSizesChange:a,...o}=e,l=y(T,e.__scopeScrollArea),[i,c]=s.useState(),d=s.useRef(null),u=(0,p.s)(t,d,l.onScrollbarXChange);return s.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),(0,n.jsx)(I,{"data-orientation":"horizontal",...o,ref:u,sizes:r,style:{bottom:0,left:"rtl"===l.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===l.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":G(r)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.x),onDragScroll:t=>e.onDragScroll(t.x),onWheelScroll:(t,r)=>{if(l.viewport){let n=l.viewport.scrollLeft+t.deltaX;e.onWheelScroll(n),function(e,t){return e>0&&e<t}(n,r)&&t.preventDefault()}},onResize:()=>{d.current&&l.viewport&&i&&a({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:$(i.paddingLeft),paddingEnd:$(i.paddingRight)}})}})}),L=s.forwardRef((e,t)=>{let{sizes:r,onSizesChange:a,...o}=e,l=y(T,e.__scopeScrollArea),[i,c]=s.useState(),d=s.useRef(null),u=(0,p.s)(t,d,l.onScrollbarYChange);return s.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),(0,n.jsx)(I,{"data-orientation":"vertical",...o,ref:u,sizes:r,style:{top:0,right:"ltr"===l.dir?0:void 0,left:"rtl"===l.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":G(r)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.y),onDragScroll:t=>e.onDragScroll(t.y),onWheelScroll:(t,r)=>{if(l.viewport){let n=l.viewport.scrollTop+t.deltaY;e.onWheelScroll(n),function(e,t){return e>0&&e<t}(n,r)&&t.preventDefault()}},onResize:()=>{d.current&&l.viewport&&i&&a({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:$(i.paddingTop),paddingEnd:$(i.paddingBottom)}})}})}),[D,z]=j(T),I=s.forwardRef((e,t)=>{let{__scopeScrollArea:r,sizes:a,hasThumb:o,onThumbChange:l,onThumbPointerUp:i,onThumbPointerDown:c,onThumbPositionChange:u,onDragScroll:h,onWheelScroll:x,onResize:m,...g}=e,j=y(T,r),[b,w]=s.useState(null),S=(0,p.s)(t,e=>w(e)),C=s.useRef(null),N=s.useRef(""),A=j.viewport,_=a.content-a.viewport,P=(0,f.c)(x),E=(0,f.c)(u),R=J(m,10);function k(e){C.current&&h({x:e.clientX-C.current.left,y:e.clientY-C.current.top})}return s.useEffect(()=>{let e=e=>{let t=e.target;b?.contains(t)&&P(e,_)};return document.addEventListener("wheel",e,{passive:!1}),()=>document.removeEventListener("wheel",e,{passive:!1})},[A,b,_,P]),s.useEffect(E,[a,E]),V(b,R),V(j.content,R),(0,n.jsx)(D,{scope:r,scrollbar:b,hasThumb:o,onThumbChange:(0,f.c)(l),onThumbPointerUp:(0,f.c)(i),onThumbPositionChange:E,onThumbPointerDown:(0,f.c)(c),children:(0,n.jsx)(d.sG.div,{...g,ref:S,style:{position:"absolute",...g.style},onPointerDown:(0,v.m)(e.onPointerDown,e=>{0===e.button&&(e.target.setPointerCapture(e.pointerId),C.current=b.getBoundingClientRect(),N.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",j.viewport&&(j.viewport.style.scrollBehavior="auto"),k(e))}),onPointerMove:(0,v.m)(e.onPointerMove,k),onPointerUp:(0,v.m)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),document.body.style.webkitUserSelect=N.current,j.viewport&&(j.viewport.style.scrollBehavior=""),C.current=null})})})}),O="ScrollAreaThumb",U=s.forwardRef((e,t)=>{let{forceMount:r,...s}=e,a=z(O,e.__scopeScrollArea);return(0,n.jsx)(u.C,{present:r||a.hasThumb,children:(0,n.jsx)(M,{ref:t,...s})})}),M=s.forwardRef((e,t)=>{let{__scopeScrollArea:r,style:a,...o}=e,l=y(O,r),i=z(O,r),{onThumbPositionChange:c}=i,u=(0,p.s)(t,e=>i.onThumbChange(e)),h=s.useRef(void 0),f=J(()=>{h.current&&(h.current(),h.current=void 0)},100);return s.useEffect(()=>{let e=l.viewport;if(e){let t=()=>{f(),h.current||(h.current=Y(e,c),c())};return c(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)}},[l.viewport,f,c]),(0,n.jsx)(d.sG.div,{"data-state":i.hasThumb?"visible":"hidden",...o,ref:u,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...a},onPointerDownCapture:(0,v.m)(e.onPointerDownCapture,e=>{let t=e.target.getBoundingClientRect(),r=e.clientX-t.left,n=e.clientY-t.top;i.onThumbPointerDown({x:r,y:n})}),onPointerUp:(0,v.m)(e.onPointerUp,i.onThumbPointerUp)})});U.displayName=O;var H="ScrollAreaCorner",F=s.forwardRef((e,t)=>{let r=y(H,e.__scopeScrollArea),s=!!(r.scrollbarX&&r.scrollbarY);return"scroll"!==r.type&&s?(0,n.jsx)(W,{...e,ref:t}):null});F.displayName=H;var W=s.forwardRef((e,t)=>{let{__scopeScrollArea:r,...a}=e,o=y(H,r),[l,i]=s.useState(0),[c,u]=s.useState(0),h=!!(l&&c);return V(o.scrollbarX,()=>{let e=o.scrollbarX?.offsetHeight||0;o.onCornerHeightChange(e),u(e)}),V(o.scrollbarY,()=>{let e=o.scrollbarY?.offsetWidth||0;o.onCornerWidthChange(e),i(e)}),h?(0,n.jsx)(d.sG.div,{...a,ref:t,style:{width:l,height:c,position:"absolute",right:"ltr"===o.dir?0:void 0,left:"rtl"===o.dir?0:void 0,bottom:0,...e.style}}):null});function $(e){return e?parseInt(e,10):0}function q(e,t){let r=e/t;return isNaN(r)?0:r}function G(e){let t=q(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd;return Math.max((e.scrollbar.size-r)*t,18)}function X(e,t,r="ltr"){let n=G(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=t.scrollbar.size-s,o=t.content-t.viewport,l=function(e,[t,r]){return Math.min(r,Math.max(t,e))}(e,"ltr"===r?[0,o]:[-1*o,0]);return B([0,o],[0,a-n])(l)}function B(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}var Y=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},n=0;return function s(){let a={left:e.scrollLeft,top:e.scrollTop},o=r.left!==a.left,l=r.top!==a.top;(o||l)&&t(),r=a,n=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(n)};function J(e,t){let r=(0,f.c)(e),n=s.useRef(0);return s.useEffect(()=>()=>window.clearTimeout(n.current),[]),s.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,t)},[r,t])}function V(e,t){let r=(0,f.c)(t);(0,m.N)(()=>{let t=0;if(e){let n=new ResizeObserver(()=>{cancelAnimationFrame(t),t=window.requestAnimationFrame(r)});return n.observe(e),()=>{window.cancelAnimationFrame(t),n.unobserve(e)}}},[e,r])}var Z=r(53028);function K({className:e,children:t,...r}){return(0,n.jsxs)(S,{"data-slot":"scroll-area",className:(0,Z.cn)("relative",e),...r,children:[(0,n.jsx)(N,{"data-slot":"scroll-area-viewport",className:"ring-ring/10 dark:ring-ring/20 dark:outline-ring/40 outline-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] focus-visible:ring-4 focus-visible:outline-1",children:t}),(0,n.jsx)(Q,{}),(0,n.jsx)(F,{})]})}function Q({className:e,orientation:t="vertical",...r}){return(0,n.jsx)(A,{"data-slot":"scroll-area-scrollbar",orientation:t,className:(0,Z.cn)("flex touch-none p-px transition-colors select-none","vertical"===t&&"h-full w-2.5 border-l border-l-transparent","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent",e),...r,children:(0,n.jsx)(U,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}var ee=r(68390),et=r(32171),er=r(16887),en=r(20459),es=r(70116),ea=r(55386);let eo=({icon:e,content:t})=>(0,n.jsxs)(ea.Tooltip,{children:[(0,n.jsx)(ea.TooltipTrigger,{asChild:!0,children:e}),(0,n.jsx)(ea.TooltipContent,{children:t})]});var el=r(40605);let ei=(0,el.createServerReference)("6066264461ac65ff787923680b0c954a1218ac5144",el.callServer,void 0,el.findSourceMapURL,"createShardset");function ec(){let{pending:e}=(0,c.useFormStatus)();return(0,n.jsx)(et.$,{type:"submit",disabled:e,children:e?"Saving...":"Save"})}function ed({index:e,columns:t,setColumns:r}){return(0,n.jsx)("div",{className:"my-4",children:(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,n.jsx)(es.J,{htmlFor:"column-name-"+e,children:"Name"}),(0,n.jsx)(en.p,{id:"column-name-"+e,className:"col-span-3",placeholder:"caption",required:!0,value:t[e].name,onChange:n=>r(t.map((t,r)=>r===e?{...t,name:n.target.value}:t))})]}),(0,n.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,n.jsx)(es.J,{htmlFor:"column-type-"+e,children:"Type"}),(0,n.jsx)(en.p,{id:"column-type-"+e,className:"col-span-3",placeholder:"text",required:!0,value:t[e].type,onChange:n=>r(t.map((t,r)=>r===e?{...t,type:n.target.value}:t))})]}),(0,n.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,n.jsxs)(es.J,{className:"flex flex-col items-start gap-0",htmlFor:"column-description-"+e,children:[(0,n.jsx)("div",{children:"Description"}),(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"(Optional)"})]}),(0,n.jsx)(en.p,{id:"column-description-"+e,className:"col-span-3",placeholder:"A caption for the image",value:t[e].description??"",onChange:n=>r(t.map((t,r)=>r===e?{...t,description:n.target.value}:t))})]})]})})}function eu({datasetId:e,children:t}){let[r,a]=(0,s.useState)(""),[c,d]=(0,s.useState)([]),[u,h]=(0,s.useState)(!1),p=(0,s.useRef)(null),f=async t=>{t.set("columnsJson",JSON.stringify(c));let r=await ei(e,t);r.success?(i.oR.success("Shardset added successfully"),h(!1),a(""),d([]),p.current?.reset()):i.oR.error(`Failed to add shardset: ${r.error}`)};return(0,n.jsxs)(er.lG,{open:u,onOpenChange:h,children:[(0,n.jsx)(er.zM,{asChild:!0,children:t}),(0,n.jsxs)(er.Cf,{className:"sm:max-w-[425px]",children:[(0,n.jsxs)(er.c7,{children:[(0,n.jsx)(er.L3,{children:"New shardset"}),(0,n.jsx)(er.rr,{children:"Add a new shardset with columns to the dataset."})]}),(0,n.jsxs)("form",{ref:p,action:f,children:[(0,n.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,n.jsx)("div",{className:"text-lg mt-2",children:"Shardset"}),(0,n.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,n.jsx)(es.J,{htmlFor:"location",className:"text-right",children:"Location"}),(0,n.jsx)(en.p,{id:"location",name:"location",className:"col-span-3",placeholder:"s3://bucket/path/to/shardset/",required:!0,value:r,onChange:e=>a(e.target.value)})]}),(0,n.jsxs)("div",{className:"text-lg mt-2 flex gap-2 items-center",children:[(0,n.jsx)("div",{children:"Columns"}),(0,n.jsx)(eo,{icon:(0,n.jsx)(o,{className:"w-4 h-4"}),content:(0,n.jsxs)("p",{children:["If you have at least one shard in the location, the columns will be inferred from the shard. ",(0,n.jsx)("br",{}),"Please specify columns if you want to override them or if you don't have any shards yet."]})})]}),(0,n.jsx)(K,{className:"max-h-[200px]",children:c.map((e,t)=>(0,n.jsxs)("div",{children:[(0,n.jsx)(ed,{index:t,columns:c,setColumns:d}),(0,n.jsx)(ee.w,{className:"my-2"})]},t))}),(0,n.jsxs)(et.$,{type:"button",variant:"outline",onClick:()=>d([...c,{name:"",type:""}]),children:[(0,n.jsx)(l,{}),"Add Column"]})]}),(0,n.jsx)(er.Es,{children:(0,n.jsx)(ec,{})})]})]})]})}},58622:e=>{e.exports="object"==typeof global&&global&&global.Object===Object&&global},58997:(e,t,r)=>{var n=r(16159),s=Object.prototype,a=s.hasOwnProperty,o=s.toString,l=n?n.toStringTag:void 0;e.exports=function(e){var t=a.call(e,l),r=e[l];try{e[l]=void 0;var n=!0}catch(e){}var s=o.call(e);return n&&(t?e[l]=r:delete e[l]),s}},59824:(e,t,r)=>{var n=r(96122),s=r(89624);e.exports=function(e){return"symbol"==typeof e||s(e)&&"[object Symbol]"==n(e)}},61641:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>c});var n=r(14125),s=r(29466),a=r(63940),o=r.n(a),l=r(339),i={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);r.d(t,i);let c={children:["",{children:["datasets",{children:["[dataset_id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,17215)),"/Users/hanch/fal/lavender-data/packages/lavender-data-ui/src/app/datasets/[dataset_id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,74723)),"/Users/hanch/fal/lavender-data/packages/lavender-data-ui/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7376,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,97801,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,31318,23)),"next/dist/client/components/unauthorized-error"]}]}.children,d=["/Users/hanch/fal/lavender-data/packages/lavender-data-ui/src/app/datasets/[dataset_id]/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},h=new n.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/datasets/[dataset_id]/page",pathname:"/datasets/[dataset_id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},67202:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},70116:(e,t,r)=>{"use strict";r.d(t,{J:()=>i});var n=r(59777),s=r(98580),a=r(23979),o=s.forwardRef((e,t)=>(0,n.jsx)(a.sG.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));o.displayName="Label";var l=r(53028);function i({className:e,...t}){return(0,n.jsx)(o,{"data-slot":"label",className:(0,l.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}},82688:(e,t,r)=>{"use strict";r.d(t,{Tooltip:()=>s,TooltipContent:()=>o,TooltipTrigger:()=>a});var n=r(18445);let s=(0,n.registerClientReference)(function(){throw Error("Attempted to call Tooltip() from the server but Tooltip is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/hanch/fal/lavender-data/packages/lavender-data-ui/src/components/ui/tooltip.tsx","Tooltip"),a=(0,n.registerClientReference)(function(){throw Error("Attempted to call TooltipTrigger() from the server but TooltipTrigger is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/hanch/fal/lavender-data/packages/lavender-data-ui/src/components/ui/tooltip.tsx","TooltipTrigger"),o=(0,n.registerClientReference)(function(){throw Error("Attempted to call TooltipContent() from the server but TooltipContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/hanch/fal/lavender-data/packages/lavender-data-ui/src/components/ui/tooltip.tsx","TooltipContent");(0,n.registerClientReference)(function(){throw Error("Attempted to call TooltipProvider() from the server but TooltipProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/hanch/fal/lavender-data/packages/lavender-data-ui/src/components/ui/tooltip.tsx","TooltipProvider")},83203:(e,t,r)=>{"use strict";function n(e){return new Date(e+(e.endsWith("Z")?"":"Z")).toLocaleString()}r.d(t,{v:()=>n})},89624:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},95705:(e,t,r)=>{"use strict";r.d(t,{K:()=>o,m:()=>l});var n=r(39717),s=r(51542),a=r(72795);let o=async()=>{let e=process.env.API_URL||"http://localhost:8000",t=await (0,s.UL)(),r=t.get("lavender-data-api-key")?.value;return(0,n.Ay)({baseUrl:e,headers:r?{Authorization:`Basic ${r}`}:{},fetch:async e=>{let t=await fetch(e,{cache:"no-store"});return(401===t.status||403===t.status)&&(0,a.redirect)("/set-api-key"),t}})},l=async e=>{let t=process.env.API_URL||"http://localhost:8000";return(0,n.Ay)({baseUrl:t,headers:{Authorization:`Basic ${e}`},fetch:async e=>fetch(e,{cache:"no-store"})})}},96122:(e,t,r)=>{var n=r(16159),s=r(58997),a=r(21536),o=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?s(e):a(e)}},96230:(e,t,r)=>{var n=r(21932),s=1/0;e.exports=function(e){return e?(e=n(e))===s||e===-s?(e<0?-1:1)*17976931348623157e292:e==e?e:0:0===e?e:0}},99672:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,87170,23)),Promise.resolve().then(r.bind(r,15029)),Promise.resolve().then(r.bind(r,67519)),Promise.resolve().then(r.bind(r,82688))}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[232,732,745,14,111,631,719,708],()=>r(61641));module.exports=n})();