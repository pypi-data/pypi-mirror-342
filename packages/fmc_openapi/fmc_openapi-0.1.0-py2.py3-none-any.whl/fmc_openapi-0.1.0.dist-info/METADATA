Metadata-Version: 2.3
Name: fmc_openapi
Version: 0.1.0
Summary: A simple Python client to interact with Cisco FMC or SCC APIs using operationId from the OpenAPI spec.
License: GPL-3.0-or-later
Keywords: Cisco,FMC,SCC,API,Swagger,OpenAPI,automation
Author: Israel Fernandez
Author-email: isrferna@cisco.com
Classifier: License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)
Classifier: Programming Language :: Python :: 2
Classifier: Programming Language :: Python :: 2.7
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.4
Classifier: Programming Language :: Python :: 3.5
Classifier: Programming Language :: Python :: 3.6
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Requires-Dist: requests (>=2.32.3,<3.0.0)
Description-Content-Type: text/markdown


# fmc_openapi

**fmc_openapi** is a Python package that simplifies interaction with Cisco Firepower Management Center (FMC) APIs. It dynamically parses the OpenAPI (Swagger) specification to discover available endpoints and interact with them using the `operationId`.

---

## ðŸš€ Features

- ðŸ” Parses the Swagger file to discover endpoints
- ðŸ’¡ Calls API operations by operationId
- ðŸ” Session handling (login/logout)
- ðŸ§° Simplifies complex API interactions
- âš ï¸ Error handling built-in
- ðŸ¢ SCC/CDO Token-Based Authentication
- ðŸ”„ Automatic pagination handling (manual pagination is also possible)
- ðŸ“¦ Bulk operations
- ðŸ“„ All endpoints defined in the Swagger spec

---

## ðŸ“¦ Installation (with Poetry)

1. Clone the repository:

```bash
git clone https://github.com/your-username/fmc_openapi.git
cd fmc_openapi
```

2. Install dependencies:

```bash
poetry install
```

3. (Optional) Activate the virtual environment:

```bash
poetry shell
```

---

## ðŸ§‘â€ðŸ’» Usage Example

### Connecting to FMC (username/password)

```python
from fmc_openapi import FMCOpenAPIClient

with FMCOpenAPIClient(
    hostname="fmc.example.com",
    username="your_username",
    password="your_password",
    verify=False
) as fmc:
    domains = fmc.operation("getAllDomain")
```

### Connecting to SCC (token-based)

```python
from fmc_openapi import FMCOpenAPIClient

with FMCOpenAPIClient(
    hostname="scc.example.com",
    token="your_token_here",
    verify=False
) as fmc:
    domains = fmc.operation("getAllDomain")
```

---

### Get all access policy rules

```python
import jmespath

with FMCOpenAPIClient(
    hostname="fmc.example.com",
    username="your_username",
    password="your_password",
    verify=False
) as fmc:
    # Get domain UUID
    domains = fmc.operation("getAllDomain")
    domain_uuid = jmespath.search("items[?name=='my-domain'].uuid | [0]", domains)

    # Get ACP UUID
    acp_response = fmc.operation("getAllAccessPolicy", domainUUID=domain_uuid)
    acp_uuid = jmespath.search("items[?name=='my-policy'].uuid | [0]", acp_response)

    # Get all access policy rules (with automatic pagination)
    rules = fmc.operation(
        "getAllAccessRule", 
        limit=1000, 
        domainUUID=domain_uuid, 
        containerUUID=acp_uuid, 
        expanded=True
    )
```

---

### Manual Pagination

```python
rules = fmc.operation(
    "getAllAccessRule",
    limit=1000,
    domainUUID=domain_uuid,
    containerUUID=acp_uuid,
    expanded=True,
    manual_pagination=True
)
```

---

### Creating Objects

```python
payload = {
    "name": "obj-192.168.1.0",
    "type": "Network",
    "value": "192.168.1.0/24",
}

fmc.operation("createMultipleNetworkObject", payload=payload, domainUUID=domain_uuid)
```

---

### Bulk Operations

```python
response = fmc.operation(
    "getHitCount", 
    limit=1000, 
    domainUUID=domain_uuid, 
    containerUUID=ac_uuid_selected, 
    filter=f"deviceId:{device_uuid}", 
    expanded=True,
    bulk=True
)
```

---

## ðŸ§ª Running Tests

Tests are written using `pytest`.

To run tests:

```bash
poetry run pytest
```

Or activate the environment first:

```bash
poetry shell
pytest
```

---

## ðŸ›  Project Structure

```
fmc_openapi/
â”œâ”€â”€ __init__.py           # Imports FMCOpenAPIClient
â”œâ”€â”€ client.py             # Main client class
â”œâ”€â”€ swagger.py            # Swagger parser
â”œâ”€â”€ utils.py              # Logging and request helpers
tests/
â”œâ”€â”€ test_swagger.py       # Tests for Swagger JSON fetching and operation extraction
â”œâ”€â”€ test_operation.py     # Tests for executing API operations using operationId
â”œâ”€â”€ test_auth.py          # Tests for authentication: login and logout
â”œâ”€â”€ test_client.py        # General client behavior and utility method tests
```

---

## ðŸ“„ License

GNU GPL v3 License. See `LICENSE` for details.

---

## ðŸ¤ Contributing

Pull requests are welcome! If you plan to add new features, open an issue first to discuss it.

1. Fork the project
2. Create your feature branch
3. Commit your changes
4. Push to the branch
5. Open a pull request

---

## âœ‰ï¸ Contact

Questions? Ideas? [Open an issue](https://github.com/isrferna/fmc_openapi/issues) or drop a message.

